<!DOCTYPE html>
<html lang="">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.74.0" />

    
    
    

<title>GPU-accelerated difference imaging â€¢ Astro Data Group</title>


<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://astrodata.nyc/fig/2020-10-09.png"/>

<meta name="twitter:title" content="GPU-accelerated difference imaging"/>
<meta name="twitter:description" content="At this week&rsquo;s meeting I shared an update about a project called PyTorchDIA led by James Hitchcock (St. Andrews) where we are looking into how numerical tools developed for machine learning can be applied to astronomy. Unlike many applications of PyTorch, TensorFlow, etc. in astronomy, I&rsquo;m not talking about using neural networks. Instead, I&rsquo;m talking about using PyTorch to compute fast convolutions and matrix-vector products to accelerate more &ldquo;traditional&rdquo; astronomy problems."/>

<meta property="og:title" content="GPU-accelerated difference imaging" />
<meta property="og:description" content="At this week&rsquo;s meeting I shared an update about a project called PyTorchDIA led by James Hitchcock (St. Andrews) where we are looking into how numerical tools developed for machine learning can be applied to astronomy. Unlike many applications of PyTorch, TensorFlow, etc. in astronomy, I&rsquo;m not talking about using neural networks. Instead, I&rsquo;m talking about using PyTorch to compute fast convolutions and matrix-vector products to accelerate more &ldquo;traditional&rdquo; astronomy problems." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://astrodata.nyc/posts/2020-10-09-pytorch-difference-imaging/" />
<meta property="og:image" content="https://astrodata.nyc/fig/2020-10-09.png" />
<meta property="article:published_time" content="2020-10-09T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-10-09T00:00:00+00:00" /><meta property="og:site_name" content="The Astronomical Data Group" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.d773a8586cc36238913d8ca94a29183adfd13d11dad198ae076b377ab46e3f23.css" integrity="sha256-13OoWGzDYjiRPYypSikYOt/RPRHa0ZiuB2s3erRuPyM=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    

</head>


    <body class="theme-base-08 ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://astrodata.nyc/">Astro Data Group</a>
      </span>
      
      
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Astro Data Group</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/">
						<span>Home</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/">
						<span>About</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/FlatironCCA" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://github.com/astrodatagroup" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2021 astrodatagroup
  
    <a href="https://creativecommons.org/licenses/by/4.0">CC-BY</a>
  
</div>



  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>GPU-accelerated difference imaging</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Oct 9, 2020
    
      
    
      
      
          by
          
          
              <a class="badge badge-category" href="/authors/dan-f-m">Dan F-M</a>
              
          
      
    
    
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 3 min read
</div>


  </header>
  
  
  <div class="post">
    <p><img src="/fig/2020-10-09.png" alt="img"></p>
<p>At this week&rsquo;s meeting I shared an update about a project called <a href="https://github.com/jah1994/PyTorchDIA">PyTorchDIA</a> led by James Hitchcock (St. Andrews) where we are looking into how numerical tools developed for machine learning can be applied to astronomy.
Unlike many applications of PyTorch, TensorFlow, etc. in astronomy, I&rsquo;m not talking about <em>using</em> neural networks.
Instead, I&rsquo;m talking about using PyTorch to compute fast convolutions and matrix-vector products to accelerate more &ldquo;traditional&rdquo; astronomy problems.
This is somewhat similar in spirit to the <a href="https://github.com/megbedell/wobble/">wobble</a> project led by Megan Bedell (that strangely has never appeared on this blog, Megan!).</p>
<p>For the PyTorchDIA project, James and I realized that we might be able to easily port <a href="https://arxiv.org/abs/astro-ph/9712287">existing difference imaging methods</a> to run on the GPU using PyTorch since the bottleneck operation is solving a large linear problem where the design matrix is a convolution.
This is exactly the type of operation encountered in deep learning applications and exactly what frameworks like <a href="https://pytorch.org">PyTorch</a> are designed for.
James took this one step further, and instead of directly solving this linear system, he uses an iterative solver that only requires matrix-vector products (rather than a full Cholesky factorization).
This allows us to relax some of the assumptions (like Gaussianity of the observation model) of the standard methods so that we can use a robust loss function instead of sigma clipping.</p>
<p>Using the GPUs available on <a href="https://colab.research.google.com">Google Colab</a>, James finds that his method is at least an order of magnitude faster than optimized implementations of other commonly used methods for difference imaging, across a wide range of realistic test cases.
We will hopefully be submitting this paper in the next week or so and we are already planning on incorporating this method into the pipelines for several existing and upcoming difference imaging surveys.
But, the real reason why I shared this with the group was that I believe that there are some (potentially) useful lessons learned:</p>
<ol>
<li>Astronomical imaging analysis shares a lot of structure with machine learning problems; let&rsquo;s take advantage of that!</li>
<li>Some of the linear problems that we work on in the group might be easier and faster to solve if we use iterative solvers rather than direct solvers. The scaling is different, but also the implementations have been optimized for the forward calculation and these methods can open the possibility of generalizing the loss function.</li>
</ol>
<p><em>Aside:</em> I also want to mention the awesome website <a href="https://weirdgalaxi.es">weirdgalaxi.es</a> (yes that is the domain name, but don&rsquo;t click on that if you&rsquo;re using Safari) that Kate Storey-Fisher made (and shared at this week&rsquo;s meeting) as a continuation of the project that <a href="https://astrodata.nyc/posts/2019-08-23-anomalies/">she previously blogged about</a>.</p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/posts/2020-10-02-binaries/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">APOGEE &#43; COSMIC =? &lt;3</span>
    </a>
    
    
    <a href="/posts/2020-10-19-kicbinaries/" class="navigation-next">
      <span class="navigation-tittle">Finding Unresolved Stellar Companions in Kepler Planet Hosts with Gaia</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    

<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/all.js" integrity="sha384-b3ua1l97aVGAPEIe48b4TC60WUQbQaGi2jqAWM90y0OZXZeyaTCWtBTKtjW2GXG1" crossorigin="anonymous"></script>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    



    



    </body>
</html>
